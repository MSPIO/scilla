import ListUtils

library Test

let one_msg = 
  fun (msg : Message) => 
    let nil_msg = Nil {Message} in
    Cons {Message} msg nil_msg

let list_length_f = @list_length (Pair(Int256)(Int256))

contract Test
()

field gmap : Map Int256 Int256 = Emp Int256 Int256
field topkey : Int256 = Int256 0

transition size()
  p <- gmap;

  mp = builtin to_list p;
  len = list_length_f mp;

  msg = {_tag : "Main"; _recipient : _sender; _amount : Uint128 0; size : len};
  msgs = one_msg msg;
  send msgs

end
